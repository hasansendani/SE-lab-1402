برای انجام این آزمایش دو سرویس ایجاد کردیم. Service1 و service2. هر دو سرویس یک API بسیار ساده توسط fastAPI هستند که صرفا یک جمله‌ی ساده را برمی‌گردانند.

سرویس شماره ۱ در صورت گرفتن درخواست get برروی آدرس 1/ خود متن زیر را برمی‌گرداند:
This is a response from service1

و در صورت گرفتن درخواست get برروی آدرس 2/ خود، یک ریکوئست get به سرویس شماره ۲ می‌زند و منتظر پاسخ می‌ماند و پاسخ را برمی‌گرداند.

سرویس شماره ۲ در صورت گرفتن درخواست get برروی آدرس 2/ خود متن زیر را برمی‌گرداند:
This is a response from service2

سرویس شماره ۱ برروی پورت ۸۰۸۳ و سرویس شماره ۲ برروی پورت ۸۰۸۲ اکسپوز می‌شوند.


هر سرویس در یک پوشه‌ی جداگانه قرار دارد. فایل requirements.txt برای هر پروژه ایجاد شده و داکرفایل هر دو پروژه تنها در نام فایل اجرایی تفاوت دارد. 

تفسیر داکرفایل:
WORKDIR /code
این خط بیانگر پوشه‌ی کار داکر است که در کانتینر ساخته شده، پوشه‌ی /code ساخته می‌شود و کارها در آن انجام می‌شود.
#
COPY ./requirements.txt /code/requirements.txt
این دستور، فایل requirements.txt را به درون پوشه‌ی code کپی می‌کند
#
RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt
این دستور توسط ابزار pip نیازمندی‌های درون requirements.txt را درون کانتینر نصب می‌کند
#
COPY . /code
این دستور تمامی محتوای پوشه‌ی فعلی را درون پوشه‌ی code کپی می‌کند
#
CMD ["python", "service1.py"]
این دستور فایل پایتون نهایی را در کانتینر اجرا می‌کند.



برای دور زدن تحریم داکر، از dns شکن استفاده کردیم. داکرفایل ها با دستور زیر بیلد شدند:
​​docker build -t service1 .






